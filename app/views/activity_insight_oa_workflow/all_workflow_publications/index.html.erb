<div class="container pt-4 pb-5">
  <%= link_to '<< Back', activity_insight_oa_workflow_path %>
  <h1 class="pb-3 pt-2">All Workflow Publications</h1>
  <table class="table">
    <thead class='card-header'>
      <tr>
        <th>Title</th>
        <th>Created At</th>
        <th>DOI Verified?</th>
        <th>Open Access Status</th>
        <th>Download Files</th>
      </tr>
    </thead>
    <tbody class='card-body'>
      <% @publications.each do |p| %>
        <tr id="<%= dom_id(p) %>">
          <td><%= link_to p.title.truncate(45),
                  rails_admin.edit_path(model_name: :publication, id: p.id) + '#publication_doi',
                  target: '_blank' %></td>
          <td><%= p.created_at.strftime("%m/%d/%Y") %></td>
          <td><% if p.doi_verified.nil? %>
                <%= 'not checked yet'%>
              <% elsif p.doi_verified %>
                <%= 'verified' %>
              <% else %>
                <%= 'verification failed' %>
              <% end %>
          </td>
          <td><%= p.open_access_status %>
          <td class="file-name"><% p.activity_insight_oa_files.each do |f| %>
                <% if f.stored_file_path.present? %>
                  <%= link_to "#{f.download_filename}",
                              activity_insight_oa_workflow_file_download_path(f.id),
                              target: '_blank' %>
                <% else %>
                  Not Found
                <% end %>
              <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
